# 金融 AI 模型的数据漂移解决方案

## 引言
此仓库包含了针对金融时间序列数据非平稳性（数据漂移）问题的高级解决方案，用于支持 AI 驱动的量化交易模型。由于金融数据分布会随时间产生变化（数据漂移），传统 AI 模型往往在市场风格切换时失效。

## 问题背景
金融市场数据具有强非平稳性特征：
- 市场数据分布会随时间变化
- 传统 AI 模型通常假设数据独立同分布（IID）
- 当市场风格切换或发生结构性变化时，模型易失效
- 有效应对数据漂移对 AI 模型的长期表现至关重要

## 应对数据漂移的三个方向

### 1. 数据分布的调整
- 在训练前或训练过程中对数据进行动态的预处理或调整
- 包括标准化、平稳化等技术

### 2. 模型结构的改进
- 设计能检测并适应分布变化的神经网络结构
- 本项目主要实现：市场特征门控和多维注意力机制

### 3. 训练模式的优化
- 在线学习、元学习及动态集成等方式
- 加速模型迭代以适应新数据分布

## 核心方法

### 市场特征门控机制
该机制将市场整体状态特征（如宽基指数的价格及成交量指标）显式引入模型：
- 根据当前市场状态动态调整个股特征的权重
- 实验结果表明，因子和组合收益表现均得到提升
- 注意力门控优于简单线性门控
- 对门控缩放系数 β 的敏感性测试显示 1-3 范围内效果最佳

### 注意力特征提取模块
使用三层注意力机制同时提取股票的时序和截面信息：
- 借鉴 Li 等 (2024) 提出的 Master 模型
- 相较传统 GRU 模型效果更好
- 在 Alpha158、MoneyFlow93、Fundamental64 三个特征集上，RankIC 平均值可提升约 0.8 个百分点
- 在 MoneyFlow93 和 Fundamental64 数据集上提升显著

## 实验结果

### 因子表现
- 改进模型产生的因子与原模型因子及传统 AI 因子的相关性较低
- 将 3 个传统 AI 因子与 6 个带门控和注意力机制的新因子等权合成后：
  - RankIC 均值：14.5%
  - RankICIR：1.43

### 组合表现（中证 1000 指数增强策略，2016.12.30 - 2025.01.27）
- 年化超额收益：25.6%
- 信息比率：3.29
- 相较于：
  - 仅使用传统 AI 因子（年化超额 22.5%，IR 2.50）
  - 仅使用 GRU 合成因子（年化超额 18.6%，IR 2.95）
  提升十分显著

## 快速开始

### 前置条件
```
Python 3.8+
PyTorch 1.12+
pandas
numpy
scikit-learn
```

### 安装
```bash
git clone https://github.com/yourusername/data_drift_solutions.git
cd data_drift_solutions
pip install -r requirements.txt
```

## 用法
请查看 examples 目录下的 Jupyter Notebook，以了解如何使用本项目提供的方法。

## 项目结构
```
data_drift_solutions/
├── data/              # 数据预处理脚本
├── models/            # 模型实现
│   ├── gating/        # 市场特征门控的实现
│   └── attention/     # 注意力特征提取模块
├── examples/          # 示例 Notebook
├── utils/             # 工具函数
└── evaluation/        # 模型评估工具
```

## 参考文献
- Li 等 (2024). Master：一种多注意力深度学习架构，用于股票走势预测。
- 更多关于金融机器学习中数据漂移的文献。

## 许可证
本项目基于 MIT License 发布，详情请参见 LICENSE 文件。